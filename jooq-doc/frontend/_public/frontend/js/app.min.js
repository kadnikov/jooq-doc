"use strict";var App=angular.module("app",["ngLocale","ngCookies","ngResource","ngSanitize","pascalprecht.translate","ui.bootstrap","ui.router","ui.utils","angular-growl","angularMoment","angularUtils.directives.dirPagination","app.partials","app.common.config","app.common.directives","app.common.services","app.search.services","app.todo.controllers","app.todo.services"]);angular.module("app.common.config",[]).config(["$urlRouterProvider","$locationProvider",function($urlRouterProvider,$locationProvider){$urlRouterProvider.otherwise("/"),$locationProvider.html5Mode(!1)}]).config(["$translateProvider",function($translateProvider){$translateProvider.useStaticFilesLoader({prefix:"/jooq/frontend/i18n/",suffix:".json"}),$translateProvider.preferredLanguage("en"),$translateProvider.useLocalStorage(),$translateProvider.useMissingTranslationHandlerLog()}]).config(["growlProvider",function(growlProvider){growlProvider.globalTimeToLive(5e3)}]),angular.module("app.common.directives",[]).directive("staticInclude",["$http","$templateCache","$compile",function($http,$templateCache,$compile){return function(scope,element,attrs){var templatePath=attrs.staticInclude;$http.get(templatePath,{cache:$templateCache}).success(function(response){var contents=$("<div/>").html(response).contents();element.html(contents),$compile(contents)(scope)})}}]),angular.module("app.common.services",[]).service("NotificationService",["$rootScope","growl",function($rootScope,growl){function displayNotification(message,type){"success"===type?growl.addSuccessMessage(message):"warn"===type?growl.addWarnMessage(message):"info"===type?growl.addInfoMessage(message):growl.addErrorMessage(message)}var flashMessageQueue=[];return $rootScope.$on("$stateChangeSuccess",function(){for(;flashMessageQueue.length>0;){var item=flashMessageQueue.shift();item&&displayNotification(item.message,item.type)}}),{flashMessage:function(message,type){flashMessageQueue.push({message:message,type:type||"info"})}}}]),angular.module("app.search.services",["ngResource"]).factory("Search",["$resource",function($resource){var api=$resource("/api/todo/search",{},{query:{method:"GET",isArray:!1}});return{findBySearchTerm:function(searchTerm,pageNumber,pageSize){return api.query({page:pageNumber,searchTerm:searchTerm,size:pageSize,sort:"ID,DESC"}).$promise}}}]),angular.module("app.todo.controllers",[]).constant("paginationConfig",{pageSize:200}).config(["$stateProvider",function($stateProvider){$stateProvider.state("todo",{url:"/","abstract":!0,template:"<ui-view/>"}).state("todo.index",{url:"",controller:"TodoListController",templateUrl:"frontend/partials/todo/todo-list.html",resolve:{searchResults:["Todos","paginationConfig",function(Todos,paginationConfig){return Todos.query(0,paginationConfig.pageSize)}]}}).state("todo.page",{url:"todo/page/:pageNumber/size/:pageSize",controller:"TodoListController",templateUrl:"frontend/partials/todo/todo-list.html",resolve:{searchResults:["Todos","$stateParams",function(Todos,$stateParams){return Todos.query($stateParams.pageNumber-1,$stateParams.pageSize)}]}}).state("todo.add",{url:"todo/add",controller:"AddTodoController",templateUrl:"frontend/partials/todo/add-todo.html"}).state("todo.edit",{url:"todo/:todoId/edit",controller:"EditTodoController",templateUrl:"frontend/partials/todo/edit-todo.html",resolve:{updatedTodo:["Todos","$stateParams",function(Todos,$stateParams){return $stateParams.todoId?Todos.get($stateParams.todoId):null}]}}).state("todo.search",{url:"todo/search/:searchTerm/page/:pageNumber/size/:pageSize",controller:"SearchResultController",templateUrl:"frontend/partials/search/search-results.html",resolve:{searchTerm:["$stateParams",function($stateParams){return $stateParams.searchTerm}],searchResults:["Search","$stateParams",function(Search,$stateParams){return $stateParams.searchTerm?Search.findBySearchTerm($stateParams.searchTerm,$stateParams.pageNumber-1,$stateParams.pageSize):null}]}}).state("todo.view",{url:"todo/:todoId",controller:"ViewTodoController",templateUrl:"frontend/partials/todo/view-todo.html",resolve:{viewedTodo:["Todos","$stateParams",function(Todos,$stateParams){return $stateParams.todoId?Todos.get($stateParams.todoId):null}]}})}]).controller("TodoListController",["$scope","$state","searchResults","paginationConfig",function($scope,$state,searchResults,paginationConfig){console.log("Rendering documents."),$scope.todos=searchResults.content,console.log(searchResults),console.log(searchResults.totalElements),console.log(paginationConfig.pageSize),$scope.pagination={currentPage:searchResults.number+1,itemsPerPage:paginationConfig.pageSize,totalItems:searchResults.totalElements},$scope.addTodo=function(){$state.go("todo.add")},$scope.pageChanged=function(newPageNumber){$state.go("todo.page",{pageNumber:newPageNumber,pageSize:paginationConfig.pageSize},{reload:!0,inherit:!0,notify:!0})}}]).controller("AddTodoController",["$scope","$state","Todos",function($scope,$state,Todos){console.log("Rendering add todo entry page."),$scope.todo={},$scope.saveTodo=function(){if($scope.todoForm.$valid){var onSuccess=function(added){$state.go("todo.view",{todoId:added.id},{reload:!0,inherit:!0,notify:!0})};Todos.save($scope.todo,onSuccess)}}}]).controller("DeleteTodoController",["$scope","$modalInstance","$state","Todos","deletedTodo",function($scope,$modalInstance,$state,Todos,deletedTodo){$scope.todo=deletedTodo,$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.delete=function(){var onSuccess=function(){$modalInstance.close(),$state.go("todo.index",{},{reload:!0,inherit:!0,notify:!0})};Todos.delete($scope.todo,onSuccess)}}]).controller("EditTodoController",["$scope","$state","updatedTodo","Todos",function($scope,$state,updatedTodo,Todos){console.log(updatedTodo),$scope.todo=updatedTodo,$scope.saveTodo=function(){if($scope.todoForm.$valid){var onSuccess=function(updated){$state.go("todo.view",{todoId:updated.id},{reload:!0,inherit:!0,notify:!0})};Todos.update($scope.todo,onSuccess)}}}]).controller("SearchController",["$scope","$state","paginationConfig",function($scope,$state,paginationConfig){var userWritingSearchTerm=!1,minimumSearchTermLength=3;$scope.missingChars=minimumSearchTermLength,$scope.searchTerm="",$scope.searchFieldBlur=function(){userWritingSearchTerm=!1},$scope.searchFieldFocus=function(){userWritingSearchTerm=!0},$scope.showMissingCharacterText=function(){return userWritingSearchTerm&&$scope.searchTerm.length<minimumSearchTermLength?!0:!1},$scope.search=function(){$scope.searchTerm.length<minimumSearchTermLength?$scope.missingChars=minimumSearchTermLength-$scope.searchTerm.length:($scope.missingChars=0,$state.go("todo.search",{searchTerm:$scope.searchTerm,pageNumber:1,pageSize:paginationConfig.pageSize},{reload:!0,inherit:!0,notify:!0}))}}]).controller("SearchResultController",["$scope","$state","paginationConfig","searchTerm","searchResults",function($scope,$state,paginationConfig,searchTerm,searchResults){console.log("Rendering search results page."),$scope.todos=searchResults.content,$scope.pagination={currentPage:searchResults.number+1,itemsPerPage:paginationConfig.pageSize,totalItems:searchResults.totalElements},$scope.pageChanged=function(newPageNumber){$state.go("todo.search",{searchTerm:searchTerm,pageNumber:newPageNumber,pageSize:paginationConfig.pageSize},{reload:!0,inherit:!0,notify:!0})}}]).controller("ViewTodoController",["$scope","$state","$modal","viewedTodo",function($scope,$state,$modal,viewedTodo){console.log("Rendering view todo entry page."),$scope.todo=viewedTodo,$scope.showEditPage=function(){$state.go("todo.edit",{todoId:$scope.todo.id},{reload:!0,inherit:!0,notify:!0})},$scope.showDeleteDialog=function(){$modal.open({templateUrl:"frontend/partials/todo/delete-todo-modal.html",controller:"DeleteTodoController",resolve:{deletedTodo:function(){return $scope.todo}}})}}]),angular.module("app.todo.services",["ngResource"]).factory("Todos",["$resource","NotificationService",function($resource,NotificationService){var api=$resource("/api/todo/:id",{id:"@id"},{query:{method:"GET",params:{},isArray:!1},get:{method:"GET"},save:{method:"POST"},update:{method:"PUT"}});return{"delete":function(todo,successCallback){return api.delete(todo,function(){NotificationService.flashMessage("todo.notifications.delete.success","success"),successCallback()})},query:function(pageNumber,pageSize){return api.query({page:pageNumber,size:pageSize,sort:"ID,DESC"}).$promise},get:function(todoId){return api.get({id:todoId}).$promise},save:function(todo,successCallback){api.save(todo,function(added){NotificationService.flashMessage("todo.notifications.add.success","success"),successCallback(added)})},update:function(todo,successCallback){api.update(todo,function(updated){NotificationService.flashMessage("todo.notifications.update.success","success"),successCallback(updated)})}}}]),angular.module("demo",["blueimp.fileupload"]).config(["$httpProvider","fileUploadProvider",function($httpProvider,fileUploadProvider){delete $httpProvider.defaults.headers.common["X-Requested-With"],fileUploadProvider.defaults.redirect=window.location.href.replace(/\/[^\/]*$/,"/cors/result.html?%s")}]).controller("DemoFileUploadController",["$scope","$http","$filter","$window",function($scope){$scope.options={url:url}}]).controller("FileDestroyController",["$scope","$http",function($scope,$http){var state,file=$scope.file;file.url?(file.$state=function(){return state},file.$destroy=function(){return state="pending",$http({url:file.deleteUrl,method:file.deleteType}).then(function(){state="resolved",$scope.clear(file)},function(){state="rejected"})}):file.$cancel||file._index||(file.$cancel=function(){$scope.clear(file)})}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsIm1vZHVsZS9jb21tb24vY29tbW9uLmNvbmZpZy5qcyIsIm1vZHVsZS9jb21tb24vY29tbW9uLmRpcmVjdGl2ZXMuanMiLCJtb2R1bGUvY29tbW9uL2NvbW1vbi5zZXJ2aWNlcy5qcyIsIm1vZHVsZS9zZWFyY2gvc2VhcmNoLnNlcnZpY2VzLmpzIiwibW9kdWxlL3RvZG8vdG9kby5jb250cm9sbGVycy5qcyIsIm1vZHVsZS90b2RvL3RvZG8uc2VydmljZXMuanMiLCJtb2R1bGUvdG9kby90b2RvLnVwbG9hZC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxZQUVBLElBQUEsS0FBQSxRQUFBLE9BQUEsT0FDQSxXQUNBLFlBQ0EsYUFDQSxhQUNBLHlCQUNBLGVBQ0EsWUFDQSxXQUNBLGdCQUNBLGdCQUNBLHdDQUdBLGVBR0Esb0JBQUEsd0JBQUEsc0JBR0Esc0JBR0EsdUJBQUEscUJDdkJBLFNBQUEsT0FBQSx3QkFDQSxRQUFBLHFCQUFBLG9CQUNBLFNBQUEsbUJBQUEsbUJBQ0EsbUJBQUEsVUFBQSxLQUdBLGtCQUFBLFdBQUEsTUFHQSxRQUFBLHFCQUFBLFNBQUEsb0JBRUEsbUJBQUEsc0JBQ0EsT0FBQSx1QkFDQSxPQUFBLFVBR0EsbUJBQUEsa0JBQUEsTUFDQSxtQkFBQSxrQkFDQSxtQkFBQSxxQ0FFQSxRQUFBLGdCQUFBLFNBQUEsZUFDQSxjQUFBLGlCQUFBLFFDckJBLFFBQUEsT0FBQSw0QkFDQSxVQUFBLGlCQUFBLFFBQUEsaUJBQUEsV0FBQSxTQUFBLE1BQUEsZUFBQSxVQUNBLE1BQUEsVUFBQSxNQUFBLFFBQUEsT0FDQSxHQUFBLGNBQUEsTUFBQSxhQUVBLE9BQUEsSUFBQSxjQUFBLE1BQUEsaUJBQUEsUUFBQSxTQUFBLFVBQ0EsR0FBQSxVQUFBLEVBQUEsVUFBQSxLQUFBLFVBQUEsVUFDQSxTQUFBLEtBQUEsVUFDQSxTQUFBLFVBQUEsYUNSQSxRQUFBLE9BQUEsMEJBQ0EsUUFBQSx1QkFBQSxhQUFBLFFBQUEsU0FBQSxXQUFBLE9BR0EsUUFBQSxxQkFBQSxRQUFBLE1BQ0EsWUFBQSxLQUNBLE1BQUEsa0JBQUEsU0FDQSxTQUFBLEtBQ0EsTUFBQSxlQUFBLFNBQ0EsU0FBQSxLQUNBLE1BQUEsZUFBQSxTQUVBLE1BQUEsZ0JBQUEsU0FWQSxHQUFBLHFCQXlCQSxPQVZBLFlBQUEsSUFBQSxzQkFBQSxXQUNBLEtBQUEsa0JBQUEsT0FBQSxHQUFBLENBQ0EsR0FBQSxNQUFBLGtCQUFBLE9BQ0EsT0FDQSxvQkFBQSxLQUFBLFFBQUEsS0FBQSxVQU9BLGFBQUEsU0FBQSxRQUFBLE1BQ0Esa0JBQUEsTUFBQSxRQUFBLFFBQUEsS0FBQSxNQUFBLGNDN0JBLFFBQUEsT0FBQSx1QkFBQSxlQUNBLFFBQUEsVUFBQSxZQUFBLFNBQUEsV0FDQSxHQUFBLEtBQUEsVUFBQSx1QkFDQSxPQUFBLE9BQUEsTUFBQSxTQUFBLElBR0EsUUFDQSxpQkFBQSxTQUFBLFdBQUEsV0FBQSxVQUNBLE1BQUEsS0FBQSxPQUFBLEtBQUEsV0FBQSxXQUFBLFdBQUEsS0FBQSxTQUFBLEtBQUEsWUFBQSxjQ1JBLFFBQUEsT0FBQSwyQkFDQSxTQUFBLG9CQUNBLFNBQUEsTUFHQSxRQUFBLGlCQUNBLFNBQUEsZ0JBQ0EsZUFDQSxNQUFBLFFBQ0EsSUFBQSxJQUNBLFlBQUEsRUFDQSxTQUFBLGVBRUEsTUFBQSxjQUNBLElBQUEsR0FDQSxXQUFBLHFCQUNBLFlBQUEsd0NBQ0EsU0FDQSxlQUFBLFFBQUEsbUJBQUEsU0FBQSxNQUFBLGtCQUNBLE1BQUEsT0FBQSxNQUFBLEVBQUEsaUJBQUEsZUFJQSxNQUFBLGFBQ0EsSUFBQSx1Q0FDQSxXQUFBLHFCQUNBLFlBQUEsd0NBQ0EsU0FDQSxlQUFBLFFBQUEsZUFBQSxTQUFBLE1BQUEsY0FDQSxNQUFBLE9BQUEsTUFBQSxhQUFBLFdBQUEsRUFBQSxhQUFBLGVBSUEsTUFBQSxZQUNBLElBQUEsV0FDQSxXQUFBLG9CQUNBLFlBQUEseUNBRUEsTUFBQSxhQUNBLElBQUEsb0JBQ0EsV0FBQSxxQkFDQSxZQUFBLHdDQUNBLFNBQ0EsYUFBQSxRQUFBLGVBQUEsU0FBQSxNQUFBLGNBQ0EsTUFBQSxjQUFBLE9BQ0EsTUFBQSxJQUFBLGFBQUEsUUFFQSxVQUlBLE1BQUEsZUFDQSxJQUFBLDBEQUNBLFdBQUEseUJBQ0EsWUFBQSwrQ0FDQSxTQUNBLFlBQUEsZUFBQSxTQUFBLGNBQ0EsTUFBQSxjQUFBLGFBRUEsZUFBQSxTQUFBLGVBQUEsU0FBQSxPQUFBLGNBQ0EsTUFBQSxjQUFBLFdBQ0EsT0FBQSxpQkFBQSxhQUFBLFdBQUEsYUFBQSxXQUFBLEVBQUEsYUFBQSxVQUdBLFVBSUEsTUFBQSxhQUNBLElBQUEsZUFDQSxXQUFBLHFCQUNBLFlBQUEsd0NBQ0EsU0FDQSxZQUFBLFFBQUEsZUFBQSxTQUFBLE1BQUEsY0FDQSxNQUFBLGNBQUEsT0FDQSxNQUFBLElBQUEsYUFBQSxRQUVBLGFBTUEsV0FBQSxzQkFBQSxTQUFBLFNBQUEsZ0JBQUEsbUJBQ0EsU0FBQSxPQUFBLE9BQUEsY0FBQSxrQkFDQSxRQUFBLElBQUEsd0JBQ0EsT0FBQSxNQUFBLGNBQUEsUUFDQSxRQUFBLElBQUEsZUFDQSxRQUFBLElBQUEsY0FBQSxlQUNBLFFBQUEsSUFBQSxpQkFBQSxVQUNBLE9BQUEsWUFDQSxZQUFBLGNBQUEsT0FBQSxFQUNBLGFBQUEsaUJBQUEsU0FDQSxXQUFBLGNBQUEsZUFHQSxPQUFBLFFBQUEsV0FDQSxPQUFBLEdBQUEsYUFHQSxPQUFBLFlBQUEsU0FBQSxlQUNBLE9BQUEsR0FBQSxhQUNBLFdBQUEsY0FBQSxTQUFBLGlCQUFBLFdBQ0EsUUFBQSxFQUFBLFNBQUEsRUFBQSxRQUFBLFFBS0EsV0FBQSxxQkFBQSxTQUFBLFNBQUEsUUFDQSxTQUFBLE9BQUEsT0FBQSxPQUNBLFFBQUEsSUFBQSxrQ0FDQSxPQUFBLFFBRUEsT0FBQSxTQUFBLFdBQ0EsR0FBQSxPQUFBLFNBQUEsT0FBQSxDQUNBLEdBQUEsV0FBQSxTQUFBLE9BQ0EsT0FBQSxHQUFBLGFBQUEsT0FBQSxNQUFBLEtBQUEsUUFBQSxFQUFBLFNBQUEsRUFBQSxRQUFBLElBR0EsT0FBQSxLQUFBLE9BQUEsS0FBQSxnQkFJQSxXQUFBLHdCQUFBLFNBQUEsaUJBQUEsU0FBQSxRQUFBLGNBQ0EsU0FBQSxPQUFBLGVBQUEsT0FBQSxNQUFBLGFBQ0EsT0FBQSxLQUFBLFlBRUEsT0FBQSxPQUFBLFdBQ0EsZUFBQSxRQUFBLFdBR0EsT0FBQSxPQUFBLFdBQ0EsR0FBQSxXQUFBLFdBQ0EsZUFBQSxRQUNBLE9BQUEsR0FBQSxpQkFBQSxRQUFBLEVBQUEsU0FBQSxFQUFBLFFBQUEsSUFFQSxPQUFBLE9BQUEsT0FBQSxLQUFBLGVBR0EsV0FBQSxzQkFBQSxTQUFBLFNBQUEsY0FBQSxRQUNBLFNBQUEsT0FBQSxPQUFBLFlBQUEsT0FDQSxRQUFBLElBQUEsYUFDQSxPQUFBLEtBQUEsWUFFQSxPQUFBLFNBQUEsV0FDQSxHQUFBLE9BQUEsU0FBQSxPQUFBLENBQ0EsR0FBQSxXQUFBLFNBQUEsU0FDQSxPQUFBLEdBQUEsYUFBQSxPQUFBLFFBQUEsS0FBQSxRQUFBLEVBQUEsU0FBQSxFQUFBLFFBQUEsSUFFQSxPQUFBLE9BQUEsT0FBQSxLQUFBLGdCQUlBLFdBQUEsb0JBQUEsU0FBQSxTQUFBLG1CQUNBLFNBQUEsT0FBQSxPQUFBLGtCQUVBLEdBQUEsd0JBQUEsRUFDQSx3QkFBQSxDQUVBLFFBQUEsYUFBQSx3QkFDQSxPQUFBLFdBQUEsR0FFQSxPQUFBLGdCQUFBLFdBQ0EsdUJBQUEsR0FHQSxPQUFBLGlCQUFBLFdBQ0EsdUJBQUEsR0FHQSxPQUFBLHlCQUFBLFdBQ0EsTUFBQSx3QkFDQSxPQUFBLFdBQUEsT0FBQSx5QkFDQSxHQUlBLEdBR0EsT0FBQSxPQUFBLFdBQ0EsT0FBQSxXQUFBLE9BQUEsd0JBQ0EsT0FBQSxhQUFBLHdCQUFBLE9BQUEsV0FBQSxRQUdBLE9BQUEsYUFBQSxFQUNBLE9BQUEsR0FBQSxlQUNBLFdBQUEsT0FBQSxXQUFBLFdBQUEsRUFBQSxTQUFBLGlCQUFBLFdBQ0EsUUFBQSxFQUFBLFNBQUEsRUFBQSxRQUFBLFNBTUEsV0FBQSwwQkFBQSxTQUFBLFNBQUEsbUJBQUEsYUFBQSxnQkFDQSxTQUFBLE9BQUEsT0FBQSxpQkFBQSxXQUFBLGVBQ0EsUUFBQSxJQUFBLGtDQUNBLE9BQUEsTUFBQSxjQUFBLFFBRUEsT0FBQSxZQUNBLFlBQUEsY0FBQSxPQUFBLEVBQ0EsYUFBQSxpQkFBQSxTQUNBLFdBQUEsY0FBQSxlQUdBLE9BQUEsWUFBQSxTQUFBLGVBQ0EsT0FBQSxHQUFBLGVBQ0EsV0FBQSxXQUFBLFdBQUEsY0FBQSxTQUFBLGlCQUFBLFdBQ0EsUUFBQSxFQUFBLFNBQUEsRUFBQSxRQUFBLFFBSUEsV0FBQSxzQkFBQSxTQUFBLFNBQUEsU0FBQSxhQUNBLFNBQUEsT0FBQSxPQUFBLE9BQUEsWUFDQSxRQUFBLElBQUEsbUNBQ0EsT0FBQSxLQUFBLFdBRUEsT0FBQSxhQUFBLFdBQ0EsT0FBQSxHQUFBLGFBQUEsT0FBQSxPQUFBLEtBQUEsS0FBQSxRQUFBLEVBQUEsU0FBQSxFQUFBLFFBQUEsS0FHQSxPQUFBLGlCQUFBLFdBQ0EsT0FBQSxNQUNBLFlBQUEsZ0RBQ0EsV0FBQSx1QkFDQSxTQUNBLFlBQUEsV0FDQSxNQUFBLFFBQUEsYUNuT0EsUUFBQSxPQUFBLHFCQUFBLGVBQ0EsUUFBQSxTQUFBLFlBQUEsc0JBQUEsU0FBQSxVQUFBLHFCQUNBLEdBQUEsS0FBQSxVQUFBLGlCQUFBLEdBQUEsUUFDQSxPQUFBLE9BQUEsTUFBQSxVQUFBLFNBQUEsR0FDQSxLQUFBLE9BQUEsT0FDQSxNQUFBLE9BQUEsUUFDQSxRQUFBLE9BQUEsUUFHQSxRQUNBLFNBQUEsU0FBQSxLQUFBLGlCQUNBLE1BQUEsS0FBQSxPQUFBLEtBQUEsV0FDQSxvQkFBQSxhQUFBLG9DQUFBLFdBQ0EscUJBR0EsTUFBQSxTQUFBLFdBQUEsVUFDQSxNQUFBLEtBQUEsT0FBQSxLQUFBLFdBQUEsS0FBQSxTQUFBLEtBQUEsWUFBQSxVQUVBLElBQUEsU0FBQSxRQUNBLE1BQUEsS0FBQSxLQUFBLEdBQUEsU0FBQSxVQUVBLEtBQUEsU0FBQSxLQUFBLGlCQUNBLElBQUEsS0FBQSxLQUFBLFNBQUEsT0FDQSxvQkFBQSxhQUFBLGlDQUFBLFdBQ0EsZ0JBQUEsVUFHQSxPQUFBLFNBQUEsS0FBQSxpQkFDQSxJQUFBLE9BQUEsS0FBQSxTQUFBLFNBQ0Esb0JBQUEsYUFBQSxvQ0FBQSxXQUNBLGdCQUFBLGdCQy9CQSxRQUFBLE9BQUEsUUFDQSx1QkFFQSxRQUNBLGdCQUFBLHFCQUNBLFNBQUEsY0FBQSwwQkFDQSxlQUFBLFNBQUEsUUFBQSxPQUFBLG9CQUNBLG1CQUFBLFNBQUEsU0FBQSxPQUFBLFNBQUEsS0FBQSxRQUNBLFlBQ0EsMkJBS0EsV0FBQSw0QkFDQSxTQUFBLFFBQUEsVUFBQSxVQUNBLFNBQUEsUUFDQSxPQUFBLFNBQ0EsSUFBQSxRQUtBLFdBQUEseUJBQ0EsU0FBQSxRQUNBLFNBQUEsT0FBQSxPQUNBLEdBQ0EsT0FEQSxLQUFBLE9BQUEsSUFFQSxNQUFBLEtBQ0EsS0FBQSxPQUFBLFdBQ0EsTUFBQSxRQUVBLEtBQUEsU0FBQSxXQUVBLE1BREEsT0FBQSxVQUNBLE9BQ0EsSUFBQSxLQUFBLFVBQ0EsT0FBQSxLQUFBLGFBQ0EsS0FDQSxXQUNBLE1BQUEsV0FDQSxPQUFBLE1BQUEsT0FFQSxXQUNBLE1BQUEsZUFJQSxLQUFBLFNBQUEsS0FBQSxTQUNBLEtBQUEsUUFBQSxXQUNBLE9BQUEsTUFBQSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG52YXIgQXBwID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFtcbiAgICAnbmdMb2NhbGUnLFxuICAgICduZ0Nvb2tpZXMnLFxuICAgICduZ1Jlc291cmNlJyxcbiAgICAnbmdTYW5pdGl6ZScsXG4gICAgJ3Bhc2NhbHByZWNodC50cmFuc2xhdGUnLFxuICAgICd1aS5ib290c3RyYXAnLFxuICAgICd1aS5yb3V0ZXInLFxuICAgICd1aS51dGlscycsXG4gICAgJ2FuZ3VsYXItZ3Jvd2wnLFxuICAgICdhbmd1bGFyTW9tZW50JyxcbiAgICAnYW5ndWxhclV0aWxzLmRpcmVjdGl2ZXMuZGlyUGFnaW5hdGlvbicsXG5cbiAgICAvL1BhcnRpYWxzXG4gICAgJ2FwcC5wYXJ0aWFscycsXG5cbiAgICAvL0NvbW1vblxuICAgICdhcHAuY29tbW9uLmNvbmZpZycsICdhcHAuY29tbW9uLmRpcmVjdGl2ZXMnLCAnYXBwLmNvbW1vbi5zZXJ2aWNlcycsXG5cbiAgICAvL1NlYXJjaFxuICAgICdhcHAuc2VhcmNoLnNlcnZpY2VzJyxcblxuICAgIC8vVG9kb1xuICAgICdhcHAudG9kby5jb250cm9sbGVycycsICdhcHAudG9kby5zZXJ2aWNlcydcblxuXSk7XG5cbiIsIid1c2Ugc3RyaWN0JztcblxuYW5ndWxhci5tb2R1bGUoJ2FwcC5jb21tb24uY29uZmlnJywgW10pXG4gICAgLmNvbmZpZyhbJyR1cmxSb3V0ZXJQcm92aWRlcicsICckbG9jYXRpb25Qcm92aWRlcicsXG4gICAgICAgIGZ1bmN0aW9uICgkdXJsUm91dGVyUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XG4gICAgICAgICAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvJyk7XG5cbiAgICAgICAgICAgIC8vIFdpdGhvdXQgc2VydmVyIHNpZGUgc3VwcG9ydCBodG1sNSBtdXN0IGJlIGRpc2FibGVkLlxuICAgICAgICAgICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKGZhbHNlKTtcbiAgICAgICAgfVxuICAgIF0pXG4gICAgLmNvbmZpZyhbJyR0cmFuc2xhdGVQcm92aWRlcicsIGZ1bmN0aW9uICgkdHJhbnNsYXRlUHJvdmlkZXIpIHtcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBhbmd1bGFyLXRyYW5zbGF0ZVxuICAgICAgICAkdHJhbnNsYXRlUHJvdmlkZXIudXNlU3RhdGljRmlsZXNMb2FkZXIoe1xuICAgICAgICAgICAgcHJlZml4OiAnL2pvb3EvZnJvbnRlbmQvaTE4bi8nLFxuICAgICAgICAgICAgc3VmZml4OiAnLmpzb24nXG4gICAgICAgIH0pO1xuXG4gICAgICAgICR0cmFuc2xhdGVQcm92aWRlci5wcmVmZXJyZWRMYW5ndWFnZSgnZW4nKTtcbiAgICAgICAgJHRyYW5zbGF0ZVByb3ZpZGVyLnVzZUxvY2FsU3RvcmFnZSgpO1xuICAgICAgICAkdHJhbnNsYXRlUHJvdmlkZXIudXNlTWlzc2luZ1RyYW5zbGF0aW9uSGFuZGxlckxvZygpO1xuICAgIH1dKVxuICAgIC5jb25maWcoWydncm93bFByb3ZpZGVyJywgZnVuY3Rpb24gKGdyb3dsUHJvdmlkZXIpIHtcbiAgICAgICAgZ3Jvd2xQcm92aWRlci5nbG9iYWxUaW1lVG9MaXZlKDUwMDApO1xuICAgIH1dKTsiLCIndXNlIHN0cmljdCc7XG5cbmFuZ3VsYXIubW9kdWxlKCdhcHAuY29tbW9uLmRpcmVjdGl2ZXMnLCBbXSlcbiAgICAuZGlyZWN0aXZlKCdzdGF0aWNJbmNsdWRlJywgWyckaHR0cCcsICckdGVtcGxhdGVDYWNoZScsICckY29tcGlsZScsIGZ1bmN0aW9uICgkaHR0cCwgJHRlbXBsYXRlQ2FjaGUsICRjb21waWxlKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgICAgICAgIHZhciB0ZW1wbGF0ZVBhdGggPSBhdHRycy5zdGF0aWNJbmNsdWRlO1xuXG4gICAgICAgICAgICAkaHR0cC5nZXQodGVtcGxhdGVQYXRoLCB7Y2FjaGU6ICR0ZW1wbGF0ZUNhY2hlfSkuc3VjY2VzcyhmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgY29udGVudHMgPSAkKCc8ZGl2Lz4nKS5odG1sKHJlc3BvbnNlKS5jb250ZW50cygpO1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuaHRtbChjb250ZW50cyk7XG4gICAgICAgICAgICAgICAgJGNvbXBpbGUoY29udGVudHMpKHNjb3BlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgIH1dKTsiLCIndXNlIHN0cmljdCc7XG5cbmFuZ3VsYXIubW9kdWxlKCdhcHAuY29tbW9uLnNlcnZpY2VzJywgW10pXG4gICAgLnNlcnZpY2UoJ05vdGlmaWNhdGlvblNlcnZpY2UnLCBbJyRyb290U2NvcGUnLCAnZ3Jvd2wnLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgZ3Jvd2wpIHtcbiAgICAgICAgdmFyIGZsYXNoTWVzc2FnZVF1ZXVlID0gW107XG5cbiAgICAgICAgZnVuY3Rpb24gZGlzcGxheU5vdGlmaWNhdGlvbihtZXNzYWdlLCB0eXBlKSB7XG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gJ3N1Y2Nlc3MnKSB7XG4gICAgICAgICAgICAgICAgZ3Jvd2wuYWRkU3VjY2Vzc01lc3NhZ2UobWVzc2FnZSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICd3YXJuJykge1xuICAgICAgICAgICAgICAgIGdyb3dsLmFkZFdhcm5NZXNzYWdlKG1lc3NhZ2UpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAnaW5mbycpIHtcbiAgICAgICAgICAgICAgICBncm93bC5hZGRJbmZvTWVzc2FnZShtZXNzYWdlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZ3Jvd2wuYWRkRXJyb3JNZXNzYWdlKG1lc3NhZ2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gRGlzcGxheSBhbGwgZmxhc2ggbm90aWZpY2F0aW9ucyBhZnRlciBzdGF0ZSBoYXMgY2hhbmdlZFxuICAgICAgICAkcm9vdFNjb3BlLiRvbihcIiRzdGF0ZUNoYW5nZVN1Y2Nlc3NcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgd2hpbGUgKGZsYXNoTWVzc2FnZVF1ZXVlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IGZsYXNoTWVzc2FnZVF1ZXVlLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgZGlzcGxheU5vdGlmaWNhdGlvbihpdGVtLm1lc3NhZ2UsIGl0ZW0udHlwZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBQdWJsaWMgQVBJXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAnZmxhc2hNZXNzYWdlJzogZnVuY3Rpb24gKG1lc3NhZ2UsIHR5cGUpIHtcbiAgICAgICAgICAgICAgICBmbGFzaE1lc3NhZ2VRdWV1ZS5wdXNoKHttZXNzYWdlOiBtZXNzYWdlLCB0eXBlOiB0eXBlIHx8ICdpbmZvJ30pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1dKTtcbiIsIid1c2Ugc3RyaWN0JztcblxuYW5ndWxhci5tb2R1bGUoJ2FwcC5zZWFyY2guc2VydmljZXMnLCBbJ25nUmVzb3VyY2UnXSlcbiAgICAuZmFjdG9yeSgnU2VhcmNoJywgWyckcmVzb3VyY2UnLCBmdW5jdGlvbigkcmVzb3VyY2UpIHtcbiAgICAgICAgdmFyIGFwaSA9ICRyZXNvdXJjZSgnL2FwaS90b2RvL3NlYXJjaCcsIHt9LCB7XG4gICAgICAgICAgICAncXVlcnknOiAge21ldGhvZDonR0VUJywgaXNBcnJheTpmYWxzZX1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGZpbmRCeVNlYXJjaFRlcm06IGZ1bmN0aW9uKHNlYXJjaFRlcm0sIHBhZ2VOdW1iZXIsIHBhZ2VTaXplKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFwaS5xdWVyeSh7cGFnZTogcGFnZU51bWJlciwgc2VhcmNoVGVybTogc2VhcmNoVGVybSwgc2l6ZTogcGFnZVNpemUsIHNvcnQ6ICdJRCxERVNDJ30pLiRwcm9taXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1dKTsiLCIndXNlIHN0cmljdCc7XG5cbmFuZ3VsYXIubW9kdWxlKCdhcHAudG9kby5jb250cm9sbGVycycsIFtdKVxuICAgIC5jb25zdGFudCgncGFnaW5hdGlvbkNvbmZpZycsIHtcbiAgICAgICAgcGFnZVNpemU6IDIwMFxuICAgIH0pXG4gICAgXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJyxcbiAgICAgICAgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgICAgIC5zdGF0ZSgndG9kbycsIHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnLycsXG4gICAgICAgICAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogJzx1aS12aWV3Lz4nXG4gICAgICAgICAgICAgICAgfSApXG4gICAgICAgICAgICAgICAgLnN0YXRlKCd0b2RvLmluZGV4Jywge1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICcnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnVG9kb0xpc3RDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdmcm9udGVuZC9wYXJ0aWFscy90b2RvL3RvZG8tbGlzdC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICAgICAgICBcdHNlYXJjaFJlc3VsdHM6IFsnVG9kb3MnLCAncGFnaW5hdGlvbkNvbmZpZycsIGZ1bmN0aW9uKFRvZG9zLCBwYWdpbmF0aW9uQ29uZmlnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFRvZG9zLnF1ZXJ5KDAsIHBhZ2luYXRpb25Db25maWcucGFnZVNpemUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgIC5zdGF0ZSgndG9kby5wYWdlJywge1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICd0b2RvL3BhZ2UvOnBhZ2VOdW1iZXIvc2l6ZS86cGFnZVNpemUnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnVG9kb0xpc3RDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdmcm9udGVuZC9wYXJ0aWFscy90b2RvL3RvZG8tbGlzdC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICAgICAgICBcdHNlYXJjaFJlc3VsdHM6IFsnVG9kb3MnLCAnJHN0YXRlUGFyYW1zJywgZnVuY3Rpb24oVG9kb3MsICRzdGF0ZVBhcmFtcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBUb2Rvcy5xdWVyeSgkc3RhdGVQYXJhbXMucGFnZU51bWJlciAtIDEsICRzdGF0ZVBhcmFtcy5wYWdlU2l6ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuc3RhdGUoJ3RvZG8uYWRkJywge1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICd0b2RvL2FkZCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdBZGRUb2RvQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnZnJvbnRlbmQvcGFydGlhbHMvdG9kby9hZGQtdG9kby5odG1sJ1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLnN0YXRlKCd0b2RvLmVkaXQnLCB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJ3RvZG8vOnRvZG9JZC9lZGl0JyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0VkaXRUb2RvQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnZnJvbnRlbmQvcGFydGlhbHMvdG9kby9lZGl0LXRvZG8uaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRUb2RvOiBbJ1RvZG9zJywgJyRzdGF0ZVBhcmFtcycsIGZ1bmN0aW9uKFRvZG9zLCAkc3RhdGVQYXJhbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHN0YXRlUGFyYW1zLnRvZG9JZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gVG9kb3MuZ2V0KCRzdGF0ZVBhcmFtcy50b2RvSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5zdGF0ZSgndG9kby5zZWFyY2gnLCB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJ3RvZG8vc2VhcmNoLzpzZWFyY2hUZXJtL3BhZ2UvOnBhZ2VOdW1iZXIvc2l6ZS86cGFnZVNpemUnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnU2VhcmNoUmVzdWx0Q29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnZnJvbnRlbmQvcGFydGlhbHMvc2VhcmNoL3NlYXJjaC1yZXN1bHRzLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWFyY2hUZXJtOiBbJyRzdGF0ZVBhcmFtcycsIGZ1bmN0aW9uKCRzdGF0ZVBhcmFtcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkc3RhdGVQYXJhbXMuc2VhcmNoVGVybTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoUmVzdWx0czogWydTZWFyY2gnLCAnJHN0YXRlUGFyYW1zJywgZnVuY3Rpb24oU2VhcmNoLCAkc3RhdGVQYXJhbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHN0YXRlUGFyYW1zLnNlYXJjaFRlcm0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFNlYXJjaC5maW5kQnlTZWFyY2hUZXJtKCRzdGF0ZVBhcmFtcy5zZWFyY2hUZXJtLCAkc3RhdGVQYXJhbXMucGFnZU51bWJlciAtIDEsICRzdGF0ZVBhcmFtcy5wYWdlU2l6ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuc3RhdGUoJ3RvZG8udmlldycsIHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAndG9kby86dG9kb0lkJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1ZpZXdUb2RvQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnZnJvbnRlbmQvcGFydGlhbHMvdG9kby92aWV3LXRvZG8uaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdlZFRvZG86IFsnVG9kb3MnLCAnJHN0YXRlUGFyYW1zJywgZnVuY3Rpb24oVG9kb3MsICRzdGF0ZVBhcmFtcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkc3RhdGVQYXJhbXMudG9kb0lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBUb2Rvcy5nZXQoJHN0YXRlUGFyYW1zLnRvZG9JZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgXSlcbiAgICAuY29udHJvbGxlcignVG9kb0xpc3RDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJHN0YXRlJywgJ3NlYXJjaFJlc3VsdHMnLCdwYWdpbmF0aW9uQ29uZmlnJyxcbiAgICAgICAgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsIHNlYXJjaFJlc3VsdHMsIHBhZ2luYXRpb25Db25maWcpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1JlbmRlcmluZyBkb2N1bWVudHMuJyk7XG4gICAgICAgICRzY29wZS50b2RvcyA9IHNlYXJjaFJlc3VsdHMuY29udGVudDtcbiAgICAgICAgY29uc29sZS5sb2coc2VhcmNoUmVzdWx0cyk7XG4gICAgICAgIGNvbnNvbGUubG9nKHNlYXJjaFJlc3VsdHMudG90YWxFbGVtZW50cyk7XG4gICAgICAgIGNvbnNvbGUubG9nKHBhZ2luYXRpb25Db25maWcucGFnZVNpemUpO1xuICAgICAgICAkc2NvcGUucGFnaW5hdGlvbiA9IHtcbiAgICAgICAgICAgIGN1cnJlbnRQYWdlOiBzZWFyY2hSZXN1bHRzLm51bWJlciArIDEsXG4gICAgICAgICAgICBpdGVtc1BlclBhZ2U6IHBhZ2luYXRpb25Db25maWcucGFnZVNpemUsXG4gICAgICAgICAgICB0b3RhbEl0ZW1zOiBzZWFyY2hSZXN1bHRzLnRvdGFsRWxlbWVudHNcbiAgICAgICAgfTtcbiAgICAgICAgXG4gICAgICAgICRzY29wZS5hZGRUb2RvID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ3RvZG8uYWRkJyk7XG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICAkc2NvcGUucGFnZUNoYW5nZWQgPSBmdW5jdGlvbihuZXdQYWdlTnVtYmVyKSB7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ3RvZG8ucGFnZScsXG4gICAgICAgICAgICAgICAge3BhZ2VOdW1iZXI6IG5ld1BhZ2VOdW1iZXIsIHBhZ2VTaXplOiBwYWdpbmF0aW9uQ29uZmlnLnBhZ2VTaXplfSxcbiAgICAgICAgICAgICAgICB7cmVsb2FkOiB0cnVlLCBpbmhlcml0OiB0cnVlLCBub3RpZnk6IHRydWV9XG4gICAgICAgICAgICApO1xuICAgICAgICB9O1xuICAgIH1dKVxuXG4gICAgLmNvbnRyb2xsZXIoJ0FkZFRvZG9Db250cm9sbGVyJywgWyckc2NvcGUnLCAnJHN0YXRlJywgJ1RvZG9zJyxcbiAgICAgICAgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsIFRvZG9zKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUmVuZGVyaW5nIGFkZCB0b2RvIGVudHJ5IHBhZ2UuJyk7XG4gICAgICAgICAgICAkc2NvcGUudG9kbyA9IHt9O1xuXG4gICAgICAgICAgICAkc2NvcGUuc2F2ZVRvZG8gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnRvZG9Gb3JtLiR2YWxpZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgb25TdWNjZXNzID0gZnVuY3Rpb24oYWRkZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygndG9kby52aWV3Jywge3RvZG9JZDogYWRkZWQuaWR9LCB7IHJlbG9hZDogdHJ1ZSwgaW5oZXJpdDogdHJ1ZSwgbm90aWZ5OiB0cnVlIH0pO1xuICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgIFRvZG9zLnNhdmUoJHNjb3BlLnRvZG8sIG9uU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ0RlbGV0ZVRvZG9Db250cm9sbGVyJywgWyckc2NvcGUnLCAnJG1vZGFsSW5zdGFuY2UnLCAnJHN0YXRlJywgJ1RvZG9zJywgJ2RlbGV0ZWRUb2RvJyxcbiAgICAgICAgZnVuY3Rpb24oJHNjb3BlLCAkbW9kYWxJbnN0YW5jZSwgJHN0YXRlLCBUb2RvcywgZGVsZXRlZFRvZG8pIHtcbiAgICAgICAgICAgICRzY29wZS50b2RvID0gZGVsZXRlZFRvZG87XG5cbiAgICAgICAgICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5kaXNtaXNzKCdjYW5jZWwnKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICRzY29wZS5kZWxldGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB2YXIgb25TdWNjZXNzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICRtb2RhbEluc3RhbmNlLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygndG9kby5pbmRleCcsIHt9LCB7IHJlbG9hZDogdHJ1ZSwgaW5oZXJpdDogdHJ1ZSwgbm90aWZ5OiB0cnVlIH0pO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgVG9kb3MuZGVsZXRlKCRzY29wZS50b2RvLCBvblN1Y2Nlc3MpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ0VkaXRUb2RvQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRzdGF0ZScsICd1cGRhdGVkVG9kbycsICdUb2RvcycsXG4gICAgICAgIGZ1bmN0aW9uKCRzY29wZSwgJHN0YXRlLCB1cGRhdGVkVG9kbywgVG9kb3MpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHVwZGF0ZWRUb2RvKTtcbiAgICAgICAgICAgICRzY29wZS50b2RvID0gdXBkYXRlZFRvZG87XG5cbiAgICAgICAgICAgICRzY29wZS5zYXZlVG9kbyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUudG9kb0Zvcm0uJHZhbGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvblN1Y2Nlc3MgPSBmdW5jdGlvbih1cGRhdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ3RvZG8udmlldycsIHt0b2RvSWQ6IHVwZGF0ZWQuaWR9LCB7IHJlbG9hZDogdHJ1ZSwgaW5oZXJpdDogdHJ1ZSwgbm90aWZ5OiB0cnVlIH0pO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBUb2Rvcy51cGRhdGUoJHNjb3BlLnRvZG8sIG9uU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1NlYXJjaENvbnRyb2xsZXInLCBbJyRzY29wZScsICckc3RhdGUnLCAncGFnaW5hdGlvbkNvbmZpZycsXG4gICAgICAgIGZ1bmN0aW9uICgkc2NvcGUsICRzdGF0ZSwgcGFnaW5hdGlvbkNvbmZpZykge1xuXG4gICAgICAgICAgICB2YXIgdXNlcldyaXRpbmdTZWFyY2hUZXJtID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgbWluaW11bVNlYXJjaFRlcm1MZW5ndGggPSAzO1xuXG4gICAgICAgICAgICAkc2NvcGUubWlzc2luZ0NoYXJzID0gbWluaW11bVNlYXJjaFRlcm1MZW5ndGg7XG4gICAgICAgICAgICAkc2NvcGUuc2VhcmNoVGVybSA9IFwiXCI7XG5cbiAgICAgICAgICAgICRzY29wZS5zZWFyY2hGaWVsZEJsdXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB1c2VyV3JpdGluZ1NlYXJjaFRlcm0gPSBmYWxzZTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICRzY29wZS5zZWFyY2hGaWVsZEZvY3VzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdXNlcldyaXRpbmdTZWFyY2hUZXJtID0gdHJ1ZTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICRzY29wZS5zaG93TWlzc2luZ0NoYXJhY3RlclRleHQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBpZiAodXNlcldyaXRpbmdTZWFyY2hUZXJtKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuc2VhcmNoVGVybS5sZW5ndGggPCBtaW5pbXVtU2VhcmNoVGVybUxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAkc2NvcGUuc2VhcmNoID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5zZWFyY2hUZXJtLmxlbmd0aCA8IG1pbmltdW1TZWFyY2hUZXJtTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5taXNzaW5nQ2hhcnMgPSBtaW5pbXVtU2VhcmNoVGVybUxlbmd0aCAtICRzY29wZS5zZWFyY2hUZXJtLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5taXNzaW5nQ2hhcnMgPSAwO1xuICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ3RvZG8uc2VhcmNoJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtzZWFyY2hUZXJtOiAkc2NvcGUuc2VhcmNoVGVybSwgcGFnZU51bWJlcjogMSwgcGFnZVNpemU6IHBhZ2luYXRpb25Db25maWcucGFnZVNpemV9LFxuICAgICAgICAgICAgICAgICAgICAgICAge3JlbG9hZDogdHJ1ZSwgaW5oZXJpdDogdHJ1ZSwgbm90aWZ5OiB0cnVlfVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgfV0pXG4gICAgLmNvbnRyb2xsZXIoJ1NlYXJjaFJlc3VsdENvbnRyb2xsZXInLCBbJyRzY29wZScsICckc3RhdGUnLCAncGFnaW5hdGlvbkNvbmZpZycsICdzZWFyY2hUZXJtJywgJ3NlYXJjaFJlc3VsdHMnLFxuICAgICAgICBmdW5jdGlvbigkc2NvcGUsICRzdGF0ZSwgcGFnaW5hdGlvbkNvbmZpZywgc2VhcmNoVGVybSwgc2VhcmNoUmVzdWx0cykge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1JlbmRlcmluZyBzZWFyY2ggcmVzdWx0cyBwYWdlLicpO1xuICAgICAgICAgICAgJHNjb3BlLnRvZG9zID0gc2VhcmNoUmVzdWx0cy5jb250ZW50O1xuXG4gICAgICAgICAgICAkc2NvcGUucGFnaW5hdGlvbiA9IHtcbiAgICAgICAgICAgICAgICBjdXJyZW50UGFnZTogc2VhcmNoUmVzdWx0cy5udW1iZXIgKyAxLFxuICAgICAgICAgICAgICAgIGl0ZW1zUGVyUGFnZTogcGFnaW5hdGlvbkNvbmZpZy5wYWdlU2l6ZSxcbiAgICAgICAgICAgICAgICB0b3RhbEl0ZW1zOiBzZWFyY2hSZXN1bHRzLnRvdGFsRWxlbWVudHNcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICRzY29wZS5wYWdlQ2hhbmdlZCA9IGZ1bmN0aW9uKG5ld1BhZ2VOdW1iZXIpIHtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ3RvZG8uc2VhcmNoJyxcbiAgICAgICAgICAgICAgICAgICAge3NlYXJjaFRlcm06IHNlYXJjaFRlcm0sIHBhZ2VOdW1iZXI6IG5ld1BhZ2VOdW1iZXIsIHBhZ2VTaXplOiBwYWdpbmF0aW9uQ29uZmlnLnBhZ2VTaXplfSxcbiAgICAgICAgICAgICAgICAgICAge3JlbG9hZDogdHJ1ZSwgaW5oZXJpdDogdHJ1ZSwgbm90aWZ5OiB0cnVlfVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XSlcbiAgICAuY29udHJvbGxlcignVmlld1RvZG9Db250cm9sbGVyJywgWyckc2NvcGUnLCAnJHN0YXRlJywgJyRtb2RhbCcsICd2aWV3ZWRUb2RvJyxcbiAgICAgICAgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsICRtb2RhbCwgdmlld2VkVG9kbykge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1JlbmRlcmluZyB2aWV3IHRvZG8gZW50cnkgcGFnZS4nKTtcbiAgICAgICAgICAgICRzY29wZS50b2RvID0gdmlld2VkVG9kbztcblxuICAgICAgICAgICAgJHNjb3BlLnNob3dFZGl0UGFnZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbyhcInRvZG8uZWRpdFwiLCB7dG9kb0lkOiAkc2NvcGUudG9kby5pZH0sIHsgcmVsb2FkOiB0cnVlLCBpbmhlcml0OiB0cnVlLCBub3RpZnk6IHRydWUgfSk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAkc2NvcGUuc2hvd0RlbGV0ZURpYWxvZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICRtb2RhbC5vcGVuKHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdmcm9udGVuZC9wYXJ0aWFscy90b2RvL2RlbGV0ZS10b2RvLW1vZGFsLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnRGVsZXRlVG9kb0NvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGVkVG9kbzogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkc2NvcGUudG9kbztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfV0pO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG5hbmd1bGFyLm1vZHVsZSgnYXBwLnRvZG8uc2VydmljZXMnLCBbJ25nUmVzb3VyY2UnXSlcbiAgICAuZmFjdG9yeSgnVG9kb3MnLCBbJyRyZXNvdXJjZScsICdOb3RpZmljYXRpb25TZXJ2aWNlJywgZnVuY3Rpb24oJHJlc291cmNlLCBOb3RpZmljYXRpb25TZXJ2aWNlKSB7XG4gICAgICAgIHZhciBhcGkgPSAkcmVzb3VyY2UoJy9hcGkvdG9kby86aWQnLCB7XCJpZFwiOiBcIkBpZFwifSwge1xuICAgICAgICAgICAgcXVlcnk6ICB7bWV0aG9kOiAnR0VUJywgcGFyYW1zOiB7fSwgaXNBcnJheTogZmFsc2V9LFxuICAgICAgICAgICAgZ2V0OiAgICB7bWV0aG9kOiAnR0VUJ30sXG4gICAgICAgICAgICBzYXZlOiB7bWV0aG9kOiAnUE9TVCd9LFxuICAgICAgICAgICAgdXBkYXRlOiB7bWV0aG9kOiAnUFVUJ31cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGRlbGV0ZTogZnVuY3Rpb24odG9kbywgc3VjY2Vzc0NhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFwaS5kZWxldGUodG9kbywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIE5vdGlmaWNhdGlvblNlcnZpY2UuZmxhc2hNZXNzYWdlKCd0b2RvLm5vdGlmaWNhdGlvbnMuZGVsZXRlLnN1Y2Nlc3MnLCAnc3VjY2VzcycpO1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzQ2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBxdWVyeTogZnVuY3Rpb24ocGFnZU51bWJlciwgcGFnZVNpemUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXBpLnF1ZXJ5KHtwYWdlOiBwYWdlTnVtYmVyLCBzaXplOiBwYWdlU2l6ZSwgc29ydDogJ0lELERFU0MnfSkuJHByb21pc2U7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbih0b2RvSWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXBpLmdldCh7aWQ6IHRvZG9JZH0pLiRwcm9taXNlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNhdmU6IGZ1bmN0aW9uKHRvZG8sIHN1Y2Nlc3NDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIGFwaS5zYXZlKHRvZG8sIGZ1bmN0aW9uKGFkZGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIE5vdGlmaWNhdGlvblNlcnZpY2UuZmxhc2hNZXNzYWdlKCd0b2RvLm5vdGlmaWNhdGlvbnMuYWRkLnN1Y2Nlc3MnLCAnc3VjY2VzcycpO1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzQ2FsbGJhY2soYWRkZWQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHVwZGF0ZTogZnVuY3Rpb24odG9kbywgc3VjY2Vzc0NhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgYXBpLnVwZGF0ZSh0b2RvLCBmdW5jdGlvbih1cGRhdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIE5vdGlmaWNhdGlvblNlcnZpY2UuZmxhc2hNZXNzYWdlKCd0b2RvLm5vdGlmaWNhdGlvbnMudXBkYXRlLnN1Y2Nlc3MnLCAnc3VjY2VzcycpO1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzQ2FsbGJhY2sodXBkYXRlZCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfV0pOyIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXIubW9kdWxlKCdkZW1vJywgW1xyXG4gICAgJ2JsdWVpbXAuZmlsZXVwbG9hZCdcclxuXSlcclxuICAgIC5jb25maWcoW1xyXG4gICAgICAgICckaHR0cFByb3ZpZGVyJywgJ2ZpbGVVcGxvYWRQcm92aWRlcicsXHJcbiAgICAgICAgZnVuY3Rpb24gKCRodHRwUHJvdmlkZXIsIGZpbGVVcGxvYWRQcm92aWRlcikge1xyXG4gICAgICAgICAgICBkZWxldGUgJGh0dHBQcm92aWRlci5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1SZXF1ZXN0ZWQtV2l0aCddO1xyXG4gICAgICAgICAgICBmaWxlVXBsb2FkUHJvdmlkZXIuZGVmYXVsdHMucmVkaXJlY3QgPSB3aW5kb3cubG9jYXRpb24uaHJlZi5yZXBsYWNlKFxyXG4gICAgICAgICAgICAgICAgL1xcL1teXFwvXSokLyxcclxuICAgICAgICAgICAgICAgICcvY29ycy9yZXN1bHQuaHRtbD8lcydcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICBdKVxyXG5cclxuICAgIC5jb250cm9sbGVyKCdEZW1vRmlsZVVwbG9hZENvbnRyb2xsZXInLCBbXHJcbiAgICAgICAgJyRzY29wZScsICckaHR0cCcsICckZmlsdGVyJywgJyR3aW5kb3cnLFxyXG4gICAgICAgIGZ1bmN0aW9uICgkc2NvcGUsICRodHRwKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5vcHRpb25zID0ge1xyXG4gICAgICAgICAgICAgICAgdXJsOiB1cmxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICBdKVxyXG5cclxuICAgIC5jb250cm9sbGVyKCdGaWxlRGVzdHJveUNvbnRyb2xsZXInLCBbXHJcbiAgICAgICAgJyRzY29wZScsICckaHR0cCcsXHJcbiAgICAgICAgZnVuY3Rpb24gKCRzY29wZSwgJGh0dHApIHtcclxuICAgICAgICAgICAgdmFyIGZpbGUgPSAkc2NvcGUuZmlsZSxcclxuICAgICAgICAgICAgICAgIHN0YXRlO1xyXG4gICAgICAgICAgICBpZiAoZmlsZS51cmwpIHtcclxuICAgICAgICAgICAgICAgIGZpbGUuJHN0YXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzdGF0ZTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBmaWxlLiRkZXN0cm95ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gJ3BlbmRpbmcnO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAkaHR0cCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogZmlsZS5kZWxldGVVcmwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogZmlsZS5kZWxldGVUeXBlXHJcbiAgICAgICAgICAgICAgICAgICAgfSkudGhlbihcclxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSAncmVzb2x2ZWQnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNsZWFyKGZpbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZSA9ICdyZWplY3RlZCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICghZmlsZS4kY2FuY2VsICYmICFmaWxlLl9pbmRleCkge1xyXG4gICAgICAgICAgICAgICAgZmlsZS4kY2FuY2VsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jbGVhcihmaWxlKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICBdKTtcclxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9